<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIT Bhopal Racing - Simple CMS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="bg-gray-50">
    <div x-data="simpleCMS()" class="min-h-screen">
        <!-- Header -->
        <header class="bg-blue-900 text-white shadow-lg">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center py-4">
                    <div class="flex items-center">
                        <h1 class="text-2xl font-bold">VIT Bhopal Racing CMS</h1>
                    </div>
                    <div class="flex items-center space-x-4">
                        <span class="text-sm">Simple Content Management</span>
                        <a href="/admin/index.html" class="bg-blue-700 hover:bg-blue-600 px-4 py-2 rounded-md text-sm transition-colors">
                            Advanced CMS
                        </a>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="bg-white shadow-sm border-b">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex space-x-8 overflow-x-auto">
                    <template x-for="section in sections" :key="section.id">
                        <button 
                            @click="activeSection = section.id"
                            :class="activeSection === section.id ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'"
                            class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors"
                        >
                            <i :class="section.icon" class="mr-2"></i>
                            <span x-text="section.name"></span>
                        </button>
                    </template>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
            <!-- Loading State -->
            <div x-show="loading" class="flex justify-center items-center h-64">
                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
            </div>

            <!-- Error State -->
            <div x-show="error && !loading" class="bg-red-50 border border-red-200 rounded-md p-4 mb-6">
                <div class="flex">
                    <i class="fas fa-exclamation-triangle text-red-400 mr-3 mt-1"></i>
                    <div>
                        <h3 class="text-sm font-medium text-red-800">Error Loading Data</h3>
                        <p class="text-sm text-red-700 mt-1" x-text="error"></p>
                        <button @click="loadData()" class="mt-2 bg-red-100 hover:bg-red-200 text-red-800 px-3 py-1 rounded text-sm">
                            Retry
                        </button>
                    </div>
                </div>
            </div>

            <!-- Content Area -->
            <div x-show="!loading && !error">
                <!-- Section Header -->
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900" x-text="getCurrentSection()?.name"></h2>
                    <p class="text-gray-600 mt-1" x-text="getCurrentSection()?.description"></p>
                </div>

                <!-- Action Buttons -->
                <div class="mb-6 flex flex-wrap gap-3">
                    <button 
                        @click="createNew()"
                        class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors"
                    >
                        <i class="fas fa-plus mr-2"></i>
                        Add New <span x-text="activeSection.slice(0, -1)"></span>
                    </button>
                    <button 
                        @click="loadData()"
                        class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors"
                    >
                        <i class="fas fa-sync-alt mr-2"></i>
                        Refresh
                    </button>
                    <button 
                        @click="exportData()"
                        class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors"
                    >
                        <i class="fas fa-download mr-2"></i>
                        Export JSON
                    </button>
                </div>

                <!-- Data Grid -->
                <div class="bg-white shadow-sm rounded-lg overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        ID
                                    </th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Title/Name
                                    </th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Type/Category
                                    </th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Date
                                    </th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Actions
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <template x-for="item in currentData" :key="item.id">
                                    <tr class="hover:bg-gray-50">
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" x-text="item.id"></td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="text-sm font-medium text-gray-900" x-text="item.title || item.name"></div>
                                            <div class="text-sm text-gray-500" x-text="(item.description || item.bio || '').substring(0, 50) + '...'"></div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span 
                                                class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800"
                                                x-text="item.category || item.role || item.type || item.status || 'N/A'"
                                            ></span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                            <span x-text="formatDate(item.date || item.start_date)"></span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                                            <button 
                                                @click="editItem(item)"
                                                class="text-indigo-600 hover:text-indigo-900 transition-colors"
                                            >
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button 
                                                @click="viewItem(item)"
                                                class="text-green-600 hover:text-green-900 transition-colors"
                                            >
                                                <i class="fas fa-eye"></i>
                                            </button>
                                            <button 
                                                @click="deleteItem(item)"
                                                class="text-red-600 hover:text-red-900 transition-colors"
                                            >
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Empty State -->
                <div x-show="currentData.length === 0" class="text-center py-12">
                    <i class="fas fa-inbox text-gray-400 text-6xl mb-4"></i>
                    <h3 class="text-lg font-medium text-gray-900 mb-2">No items found</h3>
                    <p class="text-gray-500 mb-4">Get started by creating your first item.</p>
                    <button 
                        @click="createNew()"
                        class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium"
                    >
                        <i class="fas fa-plus mr-2"></i>
                        Add New Item
                    </button>
                </div>
            </div>
        </main>

        <!-- Modal for Create/Edit -->
        <div x-show="showModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50" x-transition>
            <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white">
                <div class="mt-3">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-medium text-gray-900" x-text="modalTitle"></h3>
                        <button @click="closeModal()" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="mt-4">
                        <pre class="bg-gray-100 p-4 rounded-md text-sm overflow-auto max-h-96" x-text="JSON.stringify(selectedItem, null, 2)"></pre>
                    </div>
                    
                    <div class="flex justify-end mt-6 space-x-3">
                        <button 
                            @click="closeModal()"
                            class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded-md text-sm"
                        >
                            Close
                        </button>
                        <a 
                            href="/admin/index.html" 
                            class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm"
                        >
                            Edit in Advanced CMS
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function simpleCMS() {
            return {
                loading: true,
                error: null,
                activeSection: 'achievements',
                data: {},
                showModal: false,
                selectedItem: null,
                modalTitle: '',
                
                sections: [
                    { id: 'achievements', name: 'Achievements', icon: 'fas fa-trophy', description: 'Manage team achievements and awards' },
                    { id: 'events', name: 'Events', icon: 'fas fa-calendar', description: 'Manage upcoming and past events' },
                    { id: 'gallery', name: 'Gallery', icon: 'fas fa-images', description: 'Manage photo and video gallery' },
                    { id: 'members', name: 'Team Members', icon: 'fas fa-users', description: 'Manage team member profiles' },
                    { id: 'merchandise', name: 'Merchandise', icon: 'fas fa-shopping-bag', description: 'Manage team merchandise' },
                    { id: 'news', name: 'News', icon: 'fas fa-newspaper', description: 'Manage news articles and updates' },
                    { id: 'projects', name: 'Projects', icon: 'fas fa-cogs', description: 'Manage team projects' },
                    { id: 'racing_journey', name: 'Racing Journey', icon: 'fas fa-road', description: 'Manage racing journey milestones' },
                    { id: 'sponsors', name: 'Sponsors', icon: 'fas fa-handshake', description: 'Manage sponsor information' }
                ],
                
                get currentData() {
                    return this.data[this.activeSection] || [];
                },
                
                init() {
                    this.loadData();
                },
                
                getCurrentSection() {
                    return this.sections.find(s => s.id === this.activeSection);
                },
                
                async loadData() {
                    this.loading = true;
                    this.error = null;
                    
                    try {
                        const promises = this.sections.map(async section => {
                            try {
                                const response = await fetch(`/data/${section.id === 'racing_journey' ? 'racing-journey' : section.id}.json`);
                                if (response.ok) {
                                    const data = await response.json();
                                    return { [section.id]: Array.isArray(data) ? data : [data] };
                                }
                                return { [section.id]: [] };
                            } catch (err) {
                                console.warn(`Failed to load ${section.id}:`, err);
                                return { [section.id]: [] };
                            }
                        });
                        
                        const results = await Promise.all(promises);
                        this.data = results.reduce((acc, curr) => ({ ...acc, ...curr }), {});
                    } catch (err) {
                        this.error = err.message;
                    } finally {
                        this.loading = false;
                    }
                },
                
                createNew() {
                    alert('Create functionality requires the Advanced CMS. Redirecting...');
                    window.location.href = '/admin/index.html';
                },
                
                editItem(item) {
                    this.selectedItem = item;
                    this.modalTitle = `Edit ${item.title || item.name || 'Item'}`;
                    this.showModal = true;
                },
                
                viewItem(item) {
                    this.selectedItem = item;
                    this.modalTitle = `View ${item.title || item.name || 'Item'}`;
                    this.showModal = true;
                },
                
                deleteItem(item) {
                    if (confirm(`Are you sure you want to delete "${item.title || item.name}"?`)) {
                        alert('Delete functionality requires the Advanced CMS. Redirecting...');
                        window.location.href = '/admin/index.html';
                    }
                },
                
                closeModal() {
                    this.showModal = false;
                    this.selectedItem = null;
                },
                
                exportData() {
                    const dataStr = JSON.stringify(this.currentData, null, 2);
                    const dataBlob = new Blob([dataStr], { type: 'application/json' });
                    const url = URL.createObjectURL(dataBlob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = `${this.activeSection}.json`;
                    link.click();
                    URL.revokeObjectURL(url);
                },
                
                formatDate(dateStr) {
                    if (!dateStr) return 'N/A';
                    return new Date(dateStr).toLocaleDateString();
                }
            }
        }
    </script>
</body>
</html>
